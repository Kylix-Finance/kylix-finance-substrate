<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Trait for maps that store all its value after a unique prefix."><title>StoragePrefixedMap in lending::storage - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-5ca6ca2a1f83705a.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="lending" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0-nightly (cefe1dcef 2024-07-22)" data-channel="nightly" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../lending/index.html">lending</a><span class="version">4.0.0-dev</span></h2></div><h2 class="location"><a href="#">StoragePrefixedMap</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.module_prefix">module_prefix</a></li><li><a href="#tymethod.storage_prefix">storage_prefix</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.clear">clear</a></li><li><a href="#method.final_prefix">final_prefix</a></li><li><a href="#method.iter_values">iter_values</a></li><li><a href="#method.remove_all">remove_all</a></li><li><a href="#method.translate_values">translate_values</a></li></ul><h3><a href="#object-safety">Object Safety</a></h3><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In lending::storage</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">lending</a>::<wbr><a href="index.html">storage</a>::<wbr><a class="trait" href="#">StoragePrefixedMap</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait StoragePrefixedMap&lt;Value&gt;<div class="where">where
    Value: FullCodec,</div>{
    // Required methods
    fn <a href="#tymethod.module_prefix" class="fn">module_prefix</a>() -&gt; &amp;'static [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;&#39;static [u8]">â“˜</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.storage_prefix" class="fn">storage_prefix</a>() -&gt; &amp;'static [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;&#39;static [u8]">â“˜</a>;

    // Provided methods
    fn <a href="#method.final_prefix" class="fn">final_prefix</a>() -&gt; [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.array.html">32</a>] { ... }
<span class="item-spacer"></span>    fn <a href="#method.remove_all" class="fn">remove_all</a>(limit: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;) -&gt; <a class="enum" href="child/enum.KillStorageResult.html" title="enum lending::storage::child::KillStorageResult">KillStorageResult</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.clear" class="fn">clear</a>(limit: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, maybe_cursor: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>]&gt;) -&gt; <a class="struct" href="child/struct.MultiRemovalResults.html" title="struct lending::storage::child::MultiRemovalResults">MultiRemovalResults</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.iter_values" class="fn">iter_values</a>() -&gt; <a class="struct" href="struct.PrefixIterator.html" title="struct lending::storage::PrefixIterator">PrefixIterator</a>&lt;Value&gt; <a href="#" class="tooltip" data-notable-ty="PrefixIterator&lt;Value&gt;">â“˜</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.translate_values" class="fn">translate_values</a>&lt;OldValue, F&gt;(f: F)
       <span class="where">where OldValue: <a class="trait" href="../trait.Decode.html" title="trait lending::Decode">Decode</a>,
             F: <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(OldValue) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Value&gt;</span> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Trait for maps that store all its value after a unique prefix.</p>
<p>By default the final prefix is:</p>
<div class="example-wrap"><pre class="language-nocompile"><code>Twox128(module_prefix) ++ Twox128(storage_prefix)
</code></pre></div></div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">Â§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.module_prefix" class="method"><h4 class="code-header">fn <a href="#tymethod.module_prefix" class="fn">module_prefix</a>() -&gt; &amp;'static [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;&#39;static [u8]">â“˜</a></h4></section></summary><div class="docblock"><p>Module prefix. Used for generating final key.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.storage_prefix" class="method"><h4 class="code-header">fn <a href="#tymethod.storage_prefix" class="fn">storage_prefix</a>() -&gt; &amp;'static [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;&#39;static [u8]">â“˜</a></h4></section></summary><div class="docblock"><p>Storage prefix. Used for generating final key.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">Â§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.final_prefix" class="method"><h4 class="code-header">fn <a href="#method.final_prefix" class="fn">final_prefix</a>() -&gt; [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.array.html">32</a>]</h4></section></summary><div class="docblock"><p>Final full prefix that prefixes all keys.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.remove_all" class="method"><h4 class="code-header">fn <a href="#method.remove_all" class="fn">remove_all</a>(limit: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;) -&gt; <a class="enum" href="child/enum.KillStorageResult.html" title="enum lending::storage::child::KillStorageResult">KillStorageResult</a></h4></section><span class="item-info"><div class="stab deprecated"><span class="emoji">ðŸ‘Ž</span><span>Deprecated: Use <code>clear</code> instead</span></div></span></summary><div class="docblock"><p>Remove all values in the overlay and up to <code>limit</code> in the backend.</p>
<p>All values in the client overlay will be deleted, if there is some <code>limit</code> then up to
<code>limit</code> values are deleted from the client backend, if <code>limit</code> is none then all values in
the client backend are deleted.</p>
<h5 id="note"><a class="doc-anchor" href="#note">Â§</a>Note</h5>
<p>Calling this multiple times per block with a <code>limit</code> set leads always to the same keys being
removed and the same result being returned. This happens because the keys to delete in the
overlay are not taken into account when deleting keys in the backend.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.clear" class="method"><h4 class="code-header">fn <a href="#method.clear" class="fn">clear</a>(limit: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>, maybe_cursor: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>]&gt;) -&gt; <a class="struct" href="child/struct.MultiRemovalResults.html" title="struct lending::storage::child::MultiRemovalResults">MultiRemovalResults</a></h4></section></summary><div class="docblock"><p>Attempt to remove all items from the map.</p>
<p>Returns <a href="child/struct.MultiRemovalResults.html" title="struct lending::storage::child::MultiRemovalResults"><code>MultiRemovalResults</code></a> to inform about the result. Once
the resultant <code>maybe_cursor</code> field is <code>None</code>, then no further items remain to be deleted.</p>
<p>NOTE: After the initial call for any given map, it is important that no further items
are inserted into the map. If so, then the map may not be empty when the resultant
<code>maybe_cursor</code> is <code>None</code>.</p>
<h5 id="limit"><a class="doc-anchor" href="#limit">Â§</a>Limit</h5>
<p>A <code>limit</code> must always be provided through in order to cap the maximum
amount of deletions done in a single call. This is one fewer than the
maximum number of backend iterations which may be done by this operation and as such
represents the maximum number of backend deletions which may happen. A <code>limit</code> of zero
implies that no keys will be deleted, though there may be a single iteration done.</p>
<h5 id="cursor"><a class="doc-anchor" href="#cursor">Â§</a>Cursor</h5>
<p>A <em>cursor</em> may be passed in to this operation with <code>maybe_cursor</code>. <code>None</code> should only be
passed once (in the initial call) for any given storage map. Subsequent calls
operating on the same map should always pass <code>Some</code>, and this should be equal to the
previous call resultâ€™s <code>maybe_cursor</code> field.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.iter_values" class="method"><h4 class="code-header">fn <a href="#method.iter_values" class="fn">iter_values</a>() -&gt; <a class="struct" href="struct.PrefixIterator.html" title="struct lending::storage::PrefixIterator">PrefixIterator</a>&lt;Value&gt; <a href="#" class="tooltip" data-notable-ty="PrefixIterator&lt;Value&gt;">â“˜</a></h4></section></summary><div class="docblock"><p>Iter over all value of the storage.</p>
<p>NOTE: If a value failed to decode because storage is corrupted then it is skipped.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.translate_values" class="method"><h4 class="code-header">fn <a href="#method.translate_values" class="fn">translate_values</a>&lt;OldValue, F&gt;(f: F)<div class="where">where
    OldValue: <a class="trait" href="../trait.Decode.html" title="trait lending::Decode">Decode</a>,
    F: <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(OldValue) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Value&gt;,</div></h4></section></summary><div class="docblock"><p>Translate the values of all elements by a function <code>f</code>, in the map in no particular order.
By returning <code>None</code> from <code>f</code> for an element, youâ€™ll remove it from the map.</p>
<p>NOTE: If a value fail to decode because storage is corrupted then it is skipped.</p>
<h5 id="warning"><a class="doc-anchor" href="#warning">Â§</a>Warning</h5>
<p>This function must be used with care, before being updated the storage still contains the
old type, thus other calls (such as <code>get</code>) will fail at decoding it.</p>
<h5 id="usage"><a class="doc-anchor" href="#usage">Â§</a>Usage</h5>
<p>This would typically be called inside the module implementation of on_runtime_upgrade.</p>
</div></details></div><h2 id="object-safety" class="section-header">Object Safety<a href="#object-safety" class="anchor">Â§</a></h2><div class="object-safety-info">This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#object-safety">object safe</a>.</div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">Â§</a></h2><div id="implementors-list"><section id="impl-StoragePrefixedMap%3CValue%3E-for-StorageDoubleMap%3CPrefix,+Hasher1,+Key1,+Hasher2,+Key2,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="impl"><a href="#impl-StoragePrefixedMap%3CValue%3E-for-StorageDoubleMap%3CPrefix,+Hasher1,+Key1,+Hasher2,+Key2,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;Prefix, Hasher1, Key1, Hasher2, Key2, Value, QueryKind, OnEmpty, MaxValues&gt; <a class="trait" href="trait.StoragePrefixedMap.html" title="trait lending::storage::StoragePrefixedMap">StoragePrefixedMap</a>&lt;Value&gt; for <a class="struct" href="../struct.StorageDoubleMap.html" title="struct lending::StorageDoubleMap">StorageDoubleMap</a>&lt;Prefix, Hasher1, Key1, Hasher2, Key2, Value, QueryKind, OnEmpty, MaxValues&gt;<div class="where">where
    Prefix: StorageInstance,
    Hasher1: StorageHasher,
    Hasher2: StorageHasher,
    Key1: FullCodec,
    Key2: FullCodec,
    Value: FullCodec,
    QueryKind: <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;,
    OnEmpty: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;&lt;QueryKind as <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;&gt;::<a class="associatedtype" href="types/trait.QueryKindTrait.html#associatedtype.Query" title="type lending::storage::types::QueryKindTrait::Query">Query</a>&gt; + 'static,
    MaxValues: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;&gt;,</div></h3></section><section id="impl-StoragePrefixedMap%3CValue%3E-for-StorageMap%3CPrefix,+Hasher,+Key,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="impl"><a href="#impl-StoragePrefixedMap%3CValue%3E-for-StorageMap%3CPrefix,+Hasher,+Key,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;Prefix, Hasher, Key, Value, QueryKind, OnEmpty, MaxValues&gt; <a class="trait" href="trait.StoragePrefixedMap.html" title="trait lending::storage::StoragePrefixedMap">StoragePrefixedMap</a>&lt;Value&gt; for <a class="struct" href="../struct.StorageMap.html" title="struct lending::StorageMap">StorageMap</a>&lt;Prefix, Hasher, Key, Value, QueryKind, OnEmpty, MaxValues&gt;<div class="where">where
    Prefix: StorageInstance,
    Hasher: StorageHasher,
    Key: FullCodec,
    Value: FullCodec,
    QueryKind: <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;,
    OnEmpty: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;&lt;QueryKind as <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;&gt;::<a class="associatedtype" href="types/trait.QueryKindTrait.html#associatedtype.Query" title="type lending::storage::types::QueryKindTrait::Query">Query</a>&gt; + 'static,
    MaxValues: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;&gt;,</div></h3></section><section id="impl-StoragePrefixedMap%3CValue%3E-for-StorageNMap%3CPrefix,+Key,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="impl"><a href="#impl-StoragePrefixedMap%3CValue%3E-for-StorageNMap%3CPrefix,+Key,+Value,+QueryKind,+OnEmpty,+MaxValues%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;Prefix, Key, Value, QueryKind, OnEmpty, MaxValues&gt; <a class="trait" href="trait.StoragePrefixedMap.html" title="trait lending::storage::StoragePrefixedMap">StoragePrefixedMap</a>&lt;Value&gt; for <a class="struct" href="../struct.StorageNMap.html" title="struct lending::StorageNMap">StorageNMap</a>&lt;Prefix, Key, Value, QueryKind, OnEmpty, MaxValues&gt;<div class="where">where
    Prefix: StorageInstance,
    Key: <a class="trait" href="types/trait.KeyGenerator.html" title="trait lending::storage::types::KeyGenerator">KeyGenerator</a>,
    Value: FullCodec,
    QueryKind: <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;,
    OnEmpty: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;&lt;QueryKind as <a class="trait" href="types/trait.QueryKindTrait.html" title="trait lending::storage::types::QueryKindTrait">QueryKindTrait</a>&lt;Value, OnEmpty&gt;&gt;::<a class="associatedtype" href="types/trait.QueryKindTrait.html#associatedtype.Query" title="type lending::storage::types::QueryKindTrait::Query">Query</a>&gt; + 'static,
    MaxValues: <a class="trait" href="../trait.Get.html" title="trait lending::Get">Get</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a>&gt;&gt;,</div></h3></section></div><script src="../../trait.impl/frame_support/storage/trait.StoragePrefixedMap.js" data-ignore-extern-crates="frame_support" async></script><script type="text/json" id="notable-traits-data">{"&'static [u8]":"<h3>Notable traits for <code>&amp;[<a class=\"primitive\" href=\"https://doc.rust-lang.org/nightly/std/primitive.u8.html\">u8</a>]</code></h3><pre><code><div class=\"where\">impl <a class=\"trait\" href=\"https://doc.rust-lang.org/nightly/std/io/trait.Read.html\" title=\"trait std::io::Read\">Read</a> for &amp;[<a class=\"primitive\" href=\"https://doc.rust-lang.org/nightly/std/primitive.u8.html\">u8</a>]</div>","PrefixIterator<Value>":"<h3>Notable traits for <code><a class=\"struct\" href=\"struct.PrefixIterator.html\" title=\"struct lending::storage::PrefixIterator\">PrefixIterator</a>&lt;T, OnRemoval&gt;</code></h3><pre><code><div class=\"where\">impl&lt;T, OnRemoval&gt; <a class=\"trait\" href=\"https://doc.rust-lang.org/nightly/core/iter/traits/iterator/trait.Iterator.html\" title=\"trait core::iter::traits::iterator::Iterator\">Iterator</a> for <a class=\"struct\" href=\"struct.PrefixIterator.html\" title=\"struct lending::storage::PrefixIterator\">PrefixIterator</a>&lt;T, OnRemoval&gt;<div class=\"where\">where\n    OnRemoval: <a class=\"trait\" href=\"trait.PrefixIteratorOnRemoval.html\" title=\"trait lending::storage::PrefixIteratorOnRemoval\">PrefixIteratorOnRemoval</a>,</div></div><div class=\"where\">    type <a href=\"https://doc.rust-lang.org/nightly/core/iter/traits/iterator/trait.Iterator.html#associatedtype.Item\" class=\"associatedtype\">Item</a> = T;</div>"}</script></section></div></main></body></html>